!function(app){function listenSign(){observe(signList,function(name,value,old){"Array-unshift"==name&&!signList.status&&signList.queue.length>0&&showSignIn()})}function showSignIn(){if(signList.queue.length<=0)signList.status=!1;else{signList.status=!0;var user=signList.queue.pop();if(0==_index.length){for(i=0;i<332;i++)_index.push(i);_index.sort(function(){return.5-Math.random()})}for(var j=0;j<3;j++){if(0==_index.length){for(var i=0;i<332;i++)_index.push(i);_index.sort(function(){return.5-Math.random()})}var index=_index.pop();$(".new-card img")[index].src=user.headimg}$("#newbigcard").find("img").attr("src",user.headimg),$("#newbigcard").find("span").html(user.username+"</br>"+user.wish),$("#newbigcard").addClass("signani"),setTimeout(function(){$("#newbigcard").removeClass("signani"),setTimeout(showSignIn,1e3)},4e3)}}function init(){(camera=new THREE.PerspectiveCamera(40,1920/1080,1,1e4)).position.z=6e3,scene=new THREE.Scene;for(i=0;i<table.length;i++){var element=document.createElement("div");element.className="card new-card";var img=document.createElement("img");img.src=table[i].image,element.appendChild(img),(object=new THREE.CSS3DObject(element)).position.x=4e3*Math.random()-2e3,object.position.y=4e3*Math.random()-2e3,object.position.z=4e3*Math.random()-2e3,scene.add(object);var object1=new THREE.Object3D;object1.position.x=4e3*Math.random()-2e3,object1.position.y=4e3*Math.random()-2e3,object1.position.z=4e3*Math.random()-2e3,targets.random.push(object1),objects.push(object),(object=new THREE.Object3D).position.x=180*table[i].p_x-2730,object.position.y=-180*table[i].p_y+1e3,targets.table.push(object)}targets.table[targets.table.length-2].position.x=1e4,targets.table[targets.table.length-2].position.y=1e4,targets.table[targets.table.length-1].position.x=1e4,targets.table[targets.table.length-1].position.y=1e4;for(var vector=new THREE.Vector3,spherical=new THREE.Spherical,i=0,l=objects.length;i<l;i++){var phi=Math.acos(2*i/l-1),theta=Math.sqrt(l*Math.PI)*phi,object=new THREE.Object3D;spherical.set(1600,phi,theta),object.position.setFromSpherical(spherical),vector.copy(object.position).multiplyScalar(2),object.lookAt(vector),targets.sphere.push(object)}for(var vector=new THREE.Vector3,cylindrical=new THREE.Cylindrical,i=0,l=objects.length;i<l;i++){var theta=.175*i+Math.PI,y=-10*i+1650,object=new THREE.Object3D;cylindrical.set(900,theta,y),object.position.setFromCylindrical(cylindrical),vector.x=2*object.position.x,vector.y=object.position.y,vector.z=2*object.position.z,object.lookAt(vector),targets.helix.push(object)}for(i=0;i<objects.length;i++)(object=new THREE.Object3D).position.x=i%5*500-900,object.position.y=-Math.floor(i/5)%5*500+1e3,object.position.z=200*Math.floor(i/50)-600,targets.grid.push(object);var txtP=[],t=JSON.parse(logoPostion);for(var i in t){var o={};o.x=t[i].x,o.y=t[i].y,txtP.push(o)}for(i=0;i<objects.length;i++)(object=new THREE.Object3D).position.x=txtP[i].x,object.position.y=txtP[i].y,object.position.z=0,targets.logo.push(object);(renderer=new THREE.CSS3DRenderer).setSize(1920,1080),renderer.domElement.style.position="absolute",document.getElementById("3dcontainer").appendChild(renderer.domElement),(controls=new THREE.TrackballControls(camera,renderer.domElement)).rotateSpeed=.5,controls.minDistance=500,controls.maxDistance=6e3,controls.addEventListener("change",render);var ini=0;setInterval(function(){switch(ini){case 0:transform(targets.logo,1e3);break;case 1:transform(targets.table,1e3);break;case 2:transform(targets.logo,1e3);break;case 3:transform(targets.grid,1e3);break;case 4:transform(targets.logo,1e3);break;case 5:transform(targets.sphere,1e3);break;case 6:transform(targets.logo,1e3);break;case 7:transform(targets.helix,1e3);break;case 8:transform(targets.logo,1e3);break;case 9:transform(targets.grid,1e3)}ini=ini>=9?0:ini+1},15e3)}function transform(targets,duration){TWEEN.removeAll();for(var i=0;i<objects.length;i++){var object=objects[i],target=targets[i];new TWEEN.Tween(object.position).to({x:target.position.x,y:target.position.y,z:target.position.z},Math.random()*duration+duration).easing(TWEEN.Easing.Exponential.InOut).start(),new TWEEN.Tween(object.rotation).to({x:target.rotation.x,y:target.rotation.y,z:target.rotation.z},Math.random()*duration+duration).easing(TWEEN.Easing.Exponential.InOut).start()}new TWEEN.Tween(this).to({},2*duration).onUpdate(render).start()}function animate(){scene.rotation.y+=.01,requestAnimationFrame(animate),TWEEN.update(),controls.update(),render()}function render(){renderer.render(scene,camera)}function putUserToTable(obj){if(0==_index.length){for(i=0;i<332;i++)_index.push(i);_index.sort(function(){return.5-Math.random()})}for(i=0;i<obj.length;i++)for(var j=0;j<3;j++){if(0==_index.length){for(var i=0;i<332;i++)_index.push(i);_index.sort(function(){return.5-Math.random()})}var index=_index.pop();$(".new-card img")[index].src=obj[i].reheadimgurl}}for(var camera,scene,renderer,controls,objects=[],targets={table:[],sphere:[],helix:[],grid:[],random:[],logo:[]},personArray=new Array,logoPostion='{"173":{"x":-3340,"y":780},"174":{"x":-3210,"y":780},"180":{"x":-2430,"y":780},"181":{"x":-2300,"y":780},"213":{"x":1860,"y":780},"215":{"x":2120,"y":780},"230":{"x":-3340,"y":650},"231":{"x":-3210,"y":650},"232":{"x":-3080,"y":650},"236":{"x":-2560,"y":650},"237":{"x":-2430,"y":650},"238":{"x":-2300,"y":650},"246":{"x":-1260,"y":650},"252":{"x":-480,"y":650},"257":{"x":170,"y":650},"260":{"x":560,"y":650},"261":{"x":690,"y":650},"262":{"x":820,"y":650},"263":{"x":950,"y":650},"264":{"x":1080,"y":650},"265":{"x":1210,"y":650},"266":{"x":1340,"y":650},"269":{"x":1730,"y":650},"270":{"x":1860,"y":650},"271":{"x":1990,"y":650},"272":{"x":2120,"y":650},"273":{"x":2250,"y":650},"274":{"x":2380,"y":650},"277":{"x":2770,"y":650},"278":{"x":2900,"y":650},"279":{"x":3030,"y":650},"280":{"x":3160,"y":650},"281":{"x":3290,"y":650},"282":{"x":3420,"y":650},"283":{"x":3550,"y":650},"284":{"x":3680,"y":650},"285":{"x":-3600,"y":520},"286":{"x":-3470,"y":520},"288":{"x":-3210,"y":520},"289":{"x":-3080,"y":520},"290":{"x":-2950,"y":520},"292":{"x":-2690,"y":520},"293":{"x":-2560,"y":520},"294":{"x":-2430,"y":520},"296":{"x":-2170,"y":520},"297":{"x":-2040,"y":520},"299":{"x":-1780,"y":520},"303":{"x":-1260,"y":520},"304":{"x":-1130,"y":520},"308":{"x":-610,"y":520},"309":{"x":-480,"y":520},"312":{"x":-90,"y":520},"314":{"x":170,"y":520},"316":{"x":430,"y":520},"317":{"x":560,"y":520},"320":{"x":950,"y":520},"323":{"x":1340,"y":520},"325":{"x":1600,"y":520},"326":{"x":1730,"y":520},"329":{"x":2120,"y":520},"334":{"x":2770,"y":520},"341":{"x":3680,"y":520},"342":{"x":-3600,"y":390},"343":{"x":-3470,"y":390},"344":{"x":-3340,"y":390},"346":{"x":-3080,"y":390},"347":{"x":-2950,"y":390},"348":{"x":-2820,"y":390},"349":{"x":-2690,"y":390},"350":{"x":-2560,"y":390},"352":{"x":-2300,"y":390},"353":{"x":-2170,"y":390},"354":{"x":-2040,"y":390},"357":{"x":-1650,"y":390},"361":{"x":-1130,"y":390},"362":{"x":-1000,"y":390},"364":{"x":-740,"y":390},"365":{"x":-610,"y":390},"370":{"x":40,"y":390},"371":{"x":170,"y":390},"372":{"x":300,"y":390},"374":{"x":560,"y":390},"376":{"x":820,"y":390},"377":{"x":950,"y":390},"378":{"x":1080,"y":390},"380":{"x":1340,"y":390},"381":{"x":1470,"y":390},"383":{"x":1730,"y":390},"384":{"x":1860,"y":390},"385":{"x":1990,"y":390},"386":{"x":2120,"y":390},"387":{"x":2250,"y":390},"388":{"x":2380,"y":390},"391":{"x":2770,"y":390},"398":{"x":3680,"y":390},"400":{"x":-3470,"y":260},"401":{"x":-3340,"y":260},"402":{"x":-3210,"y":260},"404":{"x":-2950,"y":260},"405":{"x":-2820,"y":260},"406":{"x":-2690,"y":260},"408":{"x":-2430,"y":260},"409":{"x":-2300,"y":260},"410":{"x":-2170,"y":260},"415":{"x":-1520,"y":260},"420":{"x":-870,"y":260},"428":{"x":170,"y":260},"433":{"x":820,"y":260},"440":{"x":1730,"y":260},"443":{"x":2120,"y":260},"448":{"x":2770,"y":260},"453":{"x":3420,"y":260},"455":{"x":3680,"y":260},"458":{"x":-3340,"y":130},"459":{"x":-3210,"y":130},"460":{"x":-3080,"y":130},"461":{"x":-2950,"y":130},"462":{"x":-2820,"y":130},"463":{"x":-2690,"y":130},"464":{"x":-2560,"y":130},"465":{"x":-2430,"y":130},"466":{"x":-2300,"y":130},"470":{"x":-1780,"y":130},"474":{"x":-1260,"y":130},"475":{"x":-1130,"y":130},"476":{"x":-1000,"y":130},"477":{"x":-870,"y":130},"478":{"x":-740,"y":130},"479":{"x":-610,"y":130},"480":{"x":-480,"y":130},"483":{"x":-90,"y":130},"484":{"x":40,"y":130},"485":{"x":170,"y":130},"486":{"x":300,"y":130},"487":{"x":430,"y":130},"489":{"x":690,"y":130},"491":{"x":950,"y":130},"497":{"x":1730,"y":130},"498":{"x":1860,"y":130},"499":{"x":1990,"y":130},"500":{"x":2120,"y":130},"501":{"x":2250,"y":130},"502":{"x":2380,"y":130},"505":{"x":2770,"y":130},"506":{"x":2900,"y":130},"507":{"x":3030,"y":130},"508":{"x":3160,"y":130},"509":{"x":3290,"y":130},"510":{"x":3420,"y":130},"511":{"x":3550,"y":130},"512":{"x":3680,"y":130},"516":{"x":-3210,"y":0},"517":{"x":-3080,"y":0},"518":{"x":-2950,"y":0},"519":{"x":-2820,"y":0},"520":{"x":-2690,"y":0},"521":{"x":-2560,"y":0},"522":{"x":-2430,"y":0},"528":{"x":-1650,"y":0},"532":{"x":-1130,"y":0},"536":{"x":-610,"y":0},"541":{"x":40,"y":0},"543":{"x":300,"y":0},"545":{"x":560,"y":0},"548":{"x":950,"y":0},"554":{"x":1730,"y":0},"557":{"x":2120,"y":0},"562":{"x":2770,"y":0},"566":{"x":3290,"y":0},"567":{"x":3420,"y":0},"569":{"x":3680,"y":0},"572":{"x":-3340,"y":-130},"573":{"x":-3210,"y":-130},"574":{"x":-3080,"y":-130},"575":{"x":-2950,"y":-130},"576":{"x":-2820,"y":-130},"577":{"x":-2690,"y":-130},"578":{"x":-2560,"y":-130},"579":{"x":-2430,"y":-130},"580":{"x":-2300,"y":-130},"586":{"x":-1520,"y":-130},"588":{"x":-1260,"y":-130},"594":{"x":-480,"y":-130},"598":{"x":40,"y":-130},"600":{"x":300,"y":-130},"602":{"x":560,"y":-130},"603":{"x":690,"y":-130},"604":{"x":820,"y":-130},"605":{"x":950,"y":-130},"606":{"x":1080,"y":-130},"607":{"x":1210,"y":-130},"611":{"x":1730,"y":-130},"612":{"x":1860,"y":-130},"613":{"x":1990,"y":-130},"614":{"x":2120,"y":-130},"615":{"x":2250,"y":-130},"616":{"x":2380,"y":-130},"619":{"x":2770,"y":-130},"622":{"x":3160,"y":-130},"624":{"x":3420,"y":-130},"626":{"x":3680,"y":-130},"628":{"x":-3470,"y":-260},"629":{"x":-3340,"y":-260},"630":{"x":-3210,"y":-260},"632":{"x":-2950,"y":-260},"633":{"x":-2820,"y":-260},"634":{"x":-2690,"y":-260},"636":{"x":-2430,"y":-260},"637":{"x":-2300,"y":-260},"638":{"x":-2170,"y":-260},"644":{"x":-1390,"y":-260},"645":{"x":-1260,"y":-260},"646":{"x":-1130,"y":-260},"647":{"x":-1000,"y":-260},"648":{"x":-870,"y":-260},"649":{"x":-740,"y":-260},"650":{"x":-610,"y":-260},"651":{"x":-480,"y":-260},"652":{"x":-350,"y":-260},"655":{"x":40,"y":-260},"657":{"x":300,"y":-260},"662":{"x":950,"y":-260},"668":{"x":1730,"y":-260},"671":{"x":2120,"y":-260},"676":{"x":2770,"y":-260},"678":{"x":3030,"y":-260},"681":{"x":3420,"y":-260},"683":{"x":3680,"y":-260},"684":{"x":-3600,"y":-390},"685":{"x":-3470,"y":-390},"686":{"x":-3340,"y":-390},"688":{"x":-3080,"y":-390},"689":{"x":-2950,"y":-390},"690":{"x":-2820,"y":-390},"691":{"x":-2690,"y":-390},"692":{"x":-2560,"y":-390},"694":{"x":-2300,"y":-390},"695":{"x":-2170,"y":-390},"696":{"x":-2040,"y":-390},"699":{"x":-1650,"y":-390},"702":{"x":-1260,"y":-390},"704":{"x":-1000,"y":-390},"706":{"x":-740,"y":-390},"708":{"x":-480,"y":-390},"712":{"x":40,"y":-390},"714":{"x":300,"y":-390},"715":{"x":430,"y":-390},"717":{"x":690,"y":-390},"718":{"x":820,"y":-390},"719":{"x":950,"y":-390},"720":{"x":1080,"y":-390},"721":{"x":1210,"y":-390},"722":{"x":1340,"y":-390},"724":{"x":1600,"y":-390},"725":{"x":1730,"y":-390},"726":{"x":1860,"y":-390},"727":{"x":1990,"y":-390},"728":{"x":2120,"y":-390},"729":{"x":2250,"y":-390},"730":{"x":2380,"y":-390},"731":{"x":2510,"y":-390},"733":{"x":2770,"y":-390},"734":{"x":2900,"y":-390},"738":{"x":3420,"y":-390},"740":{"x":3680,"y":-390},"741":{"x":-3600,"y":-520},"742":{"x":-3470,"y":-520},"744":{"x":-3210,"y":-520},"745":{"x":-3080,"y":-520},"746":{"x":-2950,"y":-520},"748":{"x":-2690,"y":-520},"749":{"x":-2560,"y":-520},"750":{"x":-2430,"y":-520},"752":{"x":-2170,"y":-520},"753":{"x":-2040,"y":-520},"755":{"x":-1780,"y":-520},"759":{"x":-1260,"y":-520},"761":{"x":-1000,"y":-520},"763":{"x":-740,"y":-520},"765":{"x":-480,"y":-520},"768":{"x":-90,"y":-520},"769":{"x":40,"y":-520},"771":{"x":300,"y":-520},"776":{"x":950,"y":-520},"784":{"x":1990,"y":-520},"785":{"x":2120,"y":-520},"786":{"x":2250,"y":-520},"790":{"x":2770,"y":-520},"793":{"x":3160,"y":-520},"794":{"x":3290,"y":-520},"795":{"x":3420,"y":-520},"797":{"x":3680,"y":-520},"800":{"x":-3340,"y":-650},"801":{"x":-3210,"y":-650},"802":{"x":-3080,"y":-650},"806":{"x":-2560,"y":-650},"807":{"x":-2430,"y":-650},"808":{"x":-2300,"y":-650},"811":{"x":-1910,"y":-650},"814":{"x":-1520,"y":-650},"815":{"x":-1390,"y":-650},"816":{"x":-1260,"y":-650},"817":{"x":-1130,"y":-650},"818":{"x":-1000,"y":-650},"819":{"x":-870,"y":-650},"820":{"x":-740,"y":-650},"821":{"x":-610,"y":-650},"822":{"x":-480,"y":-650},"823":{"x":-350,"y":-650},"824":{"x":-220,"y":-650},"833":{"x":950,"y":-650},"840":{"x":1860,"y":-650},"842":{"x":2120,"y":-650},"844":{"x":2380,"y":-650},"847":{"x":2770,"y":-650},"854":{"x":3680,"y":-650},"857":{"x":-3340,"y":-780},"858":{"x":-3210,"y":-780},"864":{"x":-2430,"y":-780},"865":{"x":-2300,"y":-780},"890":{"x":950,"y":-780},"896":{"x":1730,"y":-780},"899":{"x":2120,"y":-780},"902":{"x":2510,"y":-780},"904":{"x":2770,"y":-780},"905":{"x":2900,"y":-780},"906":{"x":3030,"y":-780},"907":{"x":3160,"y":-780},"908":{"x":3290,"y":-780},"909":{"x":3420,"y":-780},"910":{"x":3550,"y":-780},"911":{"x":3680,"y":-780}}',signList={status:!1,queue:[]},_index=[],i=0;i<332;i++)personArray.push({image:pageInfo.path+"static/resource/img/timg.png"}),_index.push(i),_index.sort(function(){return.5-Math.random()});for(var table=new Array,i=0;i<personArray.length;i++)table[i]=new Object,i<personArray.length&&(table[i]=personArray[i],table[i].src=personArray[i].thumb_image),table[i].p_x=i%30+1,table[i].p_y=Math.floor(i/30)+1;var isFirst=!1;app.sign={init:function(){isFirst||(isFirst=!0,init(),animate(),listenSign(),0==userJoinedArr.length?$.get(gameHost+"/reportController/report/"+pageInfo.roomId,function(data){$("#current-people").html(data.data.length+""),userJoinedArr=data.data,$(".card").find("img").attr("onerror","errorImg(this)"),$(".bigCard").find("img").attr("onerror","errorImg(this)"),putUserToTable(userJoinedArr)},"json").error(function(){$(".card").find("img").attr("onerror","errorImg(this)"),$(".bigCard").find("img").attr("onerror","errorImg(this)"),putUserToTable(userJoinedArr)}):(putUserToTable(userJoinedArr),$(".card").find("img").attr("onerror","errorImg(this)"),$(".bigCard").find("img").attr("onerror","errorImg(this)")))},add:function(){signList.queue.unshift({headimg:"http://www.chinanews.com/cr/2013/1122/796252081.jpg"})},addToQueue:function(obj){signList.queue.unshift({headimg:obj.photoUrl,username:obj.userName,wish:obj.wish})}}}(window.hdAPP||(window.hdAPP={}));